---
date: 2015-10-08T01:51:06+09:00
draft: false
slug: ""
socialsharing: true
tags:
- "ubuntu"
- "comskip"
title: comskip.iniに書くべきたった一つの重要な設定
---
タイトルはまあ釣りなんですが、全然まともに検出できなくておかしいと思っていたのが、一つのツイートから解決したので記録に残しておきます。
現時点で真っ先にcomskip.iniに書くべき設定、それは…
<!--more-->
```
thread_count=1
```

これです。処理時間は犠牲になりますが、マルチスレッドを無効にしましょう。
[このツイート](https://twitter.com/gleentea/status/493458493030936576) を見た瞬間、「あ、これは確認しないと」と思いました。
見えている画像が違うのですから、まともな検出が出来ないのも仕方ない話で。

ちなみに最初に使っていたのが[comskip-0.93i](http://forum.kodi.tv/showthread.php?tid=150084)で、今使っているのが[erikkaashoek版のmaster](https://github.com/erikkaashoek/Comskip)
です。
どちらも、デフォルトの設定で動かしている裏でtopで見るとCPUが150%くらい行くので、マルチスレッドで動いているようです。
（comskip-0.93iは-DDONATOR付けないとシングルスレッドになるようなソースにも見えるんだけど・・・謎）

で、マルチスレッドで動いていると上記のツイートのように画像がおかしなことになっているらしく、comskip.iniの設定をあれこれいじってもまともに検出できない。
一方で、`thread_count=1`を付けてやると割とどんな設定でもそれなりに検出できる様子です。

ちなみに、ほとんどのサイトで出力はoutput_vdrが良いと書いてありますが、output_ipodchapも付けておくと良い感じです。この形式は、ファイル名だけ変えてやればmp4chapsで
そのままエンコードしたMP4へのチャプター埋め込みに使えるのです。いきなりカットするのはさすがに怖いので、MP4で事前に確認しようと思うと、この方法が便利なのです。
